clc;
clear all ;
close all;
format long g;
a1=3;
a2=0.002;
b1=0.0006;
b2=0.5;
h=0.1;
y=0:h:10;
n=length(y);
x(1)=1000;
w(1)=500;
for i=2:n
    k11=h*((a1*(x(i-1)))-(a2*(x(i-1))*(w(i-1))));
    k21=h*((b1*(x(i-1))*(w(i-1)))-(b2*(w(i-1))));
   
    k12=h*((a1*(x(i-1)+((1/4)*k11)))-(a2*(x(i-1)+((1/4)*k11))*(w(i-1)+((1/4)*k21))));
    k22=h*((b1*(x(i-1)+((1/4)*k11))*(w(i-1)+((1/4)*k11)))-(b2*(w(i-1)+((1/4)*k21))));
    
    k13=h*((a1*(x(i-1)+(3/32*k11)+(9/32*k12)))-(a2*(x(i-1)+(3/32*k11)+(9/32*k12))*(w(i-1)+(3/32*k21)+(9/32*k22))));
    k23=h*((b1*(x(i-1)+(3/32*k11)+(9/32*k12))*(w(i-1)+(3/32*k21)+(9/32*k22)))-(b2*(w(i-1)+(3/32*k21)+(9/32*k22))));
    
    k14=h*((a1*(x(i-1)+(1932/2197*k11)-(7200/2197*k12)+(7296/2197*k13)))-(a2*(x(i-1)+(1932/2197*k11)-(7200/2197*k12)+(7296/2197*k13))*(w(i-1)+(1932/2197*k21)-(7200/2197*k22)+(7296/2197*k23))));
    k24=h*((b1*(x(i-1)+(1932/2197*k11)-(7200/2197*k12)+(7296/2197*k13)))*(w(i-1)+(1932/2197*k21)-(7200/2197*k22)+(7296/2197*k23))-(b2*(w(i-1)+(1932/2197*k21)-(7200/2197*k22)+(7296/2197*k23))));
    
    k15=h*((a1*(x(i-1)+(439/216*k11)-(8*k12)+(3680/513*k13)-(845/4104*k14)))-(a2*(x(i-1)+(439/216*k11)-(8*k12)+(3680/513*k13)-(845/4104*k14)))*(w(i-1)+(439/216*k21)-(8*k22)+(3680/513*k23)-(845/4104*k24)));
    k25=h*((b1*(x(i-1)+(439/216*k11)-(8*k12)+(3680/513*k13)-(845/4104*k14)))*(w(i-1)+(439/216*k21)-(8*k22)+(3680/513*k23)-(845/4104*k24))-(b2*(w(i-1)+(439/216*k21)-(8*k22)+(3680/513*k23)-(845/4104*k24))));
    
    k16=h*((a1*(x(i-1)-(8/27*k11)+(2*k12)-(3544/2565*k13)+(1859/4104*k14)-(11/40*k15)))-(b2*(x(i-1)-(8/27*k11)+(2*k12)-(3544/2565*k13)+(1859/4104*k14)-(11/40*k15))*(w(i-1)-(8/27*k21)+(2*k22)-(3544/2565*k23)+(1859/4104*k24)-(11/40*k25))));
    k26=h*((b1*(x(i-1)-(8/27*k11)+(2*k12)-(3544/2565*k13)+(1859/4104*k14)-(11/40*k15)))*(w(i-1)-(8/27*k21)+(2*k22)-(3544/2565*k23)+(1859/4104*k24)-(11/40*k25))-(b2*(w(i-1)-(8/27*k21)+(2*k22)-(3544/2565*k23)+(1859/4104*k24)-(11/40*k25))));
   
   
  
    x(i)=(x(i-1))+((25/216*k11)+(1408/2565*k13)+(2197/4104*k14)-(1/5*k15));
    w(i)=(w(i-1))+((25/216*k21)+(1408/2565*k23)+(2197/4104*k24)-(1/5*k25));
    
end
plot (x,w)
%plot(y,x,'b')
%hold on 
%plot(y,w,'r')
%hold off