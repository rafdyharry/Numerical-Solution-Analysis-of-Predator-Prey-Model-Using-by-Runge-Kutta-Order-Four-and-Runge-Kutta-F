clc;
clear all ;
close all;
format long g;
a=0.5;
K=20;
T=0.8;
r=0.7;
lamda=0.7;
m=0.65;
h=0.01;
y=0:h:10;
n=length(y);
P(1)=1;
I(1)=0.01;
for i=2:n
    
    k11=h*((P(i-1))*(1-(((P(i-1))^2)/((a^2)*K*(T^2))))-((1)/(2*r))*(P(i-1))*(I(i-1)));
    k21=h*((2*(I(i-1)))*((((lamda)/(2*(a^2)*r*(T^2))))*((P(i-1))^2)-m));
    
    k12=h*((P(i-1)+((1/4)*k11))*(1-(((P(i-1))^2)/((a^2)*K*(T^2))))-((1)/(2*r))*(P(i-1)+((1/4)*k11))*(I(i-1)+((1/4)*k21)));
    k22=h*((2*(I(i-1)+((1/4)*k21)))*((((lamda)/(2*(a^2)*r*(T^2))))*((P(i-1)+((1/4)*k11))^2)-m));
    
    k13=h*((P(i-1)+(3/32*k11)+(9/32*k12))*(1-(((P(i-1)+(3/32*k11)+(9/32*k12))^2)/((a^2)*K*(T^2))))-((1)/(2*r))*(P(i-1)+(3/32*k11)+(9/32*k12))*(I(i-1)+(3/32*k21)+(9/32*k22)));
    k23=h*((2*(I(i-1)+(3/32*k21)+(9/32*k22)))*((((lamda)/(2*(a^2)*r*(T^2))))*((P(i-1)+(3/32*k11)+(9/32*k12))^2)-m));
    
    k14=h*((P(i-1)+(1932/2197*k11)-(7200/2197*k12)+(7296/2197*k13))*(1-(((I(i-1)+(1932/2197*k11)-(7200/2197*k12)+(7296/2197*k13))^2)/((a^2)*K*(T^2))))-((1)/(2*r))*(P(i-1)+(1932/2197*k11)-(7200/2197*k12)+(7296/2197*k13))*(I(i-1)+(1932/2197*k21)-(7200/2197*k22)+(7296/2197*k23)));    
    k24=h*((2*(I(i-1)+(1932/2197*k21)-(7200/2197*k22)+(7296/2197*k23)))*((((lamda)/(2*(a^2)*r*(T^2))))*((P(i-1)+(1932/2197*k11)-(7200/2197*k12)+(7296/2197*k13))^2)-m));
   
    k15=h*((P(i-1)+(439/216*k11)-(8*k12)+(3680/513*k13)-(845/4104*k14))*(1-(((P(i-1)+(439/216*k11)-(8*k12)+(3680/513*k13))-(845/4104*k14)^2)/((a^2)*K*(T^2))))-((1)/(2*r))*(P(i-1)+(439/216*k11)-(8*k12)+(3680/513*k13)-(845/4104*k14))*(I(i-1)+(439/216*k21)-(8*k22)+(3680/513*k23)-(845/4104*k24)));
    k25=h*((2*(I(i-1)+(439/216*k21)-(8*k22)+(3680/513*k23)-(845/4104*k24)))*((((lamda)/(2*(a^2)*r*(T^2))))*((P(i-1)+(439/216*k11)-(8*k12)+(3680/513*k13)-(845/4104*k14))^2)-m));
    
    k16=h*((P(i-1)-(8/27*k11)+(2*k12)-(3544/2565*k13)+(1859/4104*k14)-(11/40*k15))*(1-(( (P(i-1)-(8/27*k11)+(2*k12)-(3544/2565*k13)+(1859/4104*k14)-(11/40*k15))^2)/((a^2)*K*(T^2))))-((1)/(2*r))* (P(i-1)-(8/27*k11)+(2*k12)-(3544/2565*k13)+(1859/4104*k14)-(11/40*k15))* (I(i-1)-(8/27*k21)+(2*k22)-(3544/2565*k23)+(1859/4104*k24)-(11/40*k25)));
    k26=h*((2* (I(i-1)-(8/27*k21)+(2*k22)-(3544/2565*k23)+(1859/4104*k24)-(11/40*k25)))*((((lamda)/(2*(a^2)*r*(T^2))))*((P(i-1)-(8/27*k11)+(2*k12)-(3544/2565*k13)+(1859/4104*k14)-(11/40*k15))^2)-m));
    
      
    P(i)=(P(i-1))+((25/216*k11)+(1408/2565*k13)+(2197/4104*k14)-(1/5*k15));
    I(i)=(I(i-1))+((25/216*k21)+(1408/2565*k23)+(2197/4104*k24)-(1/5*k25));
    
end
%x,w
plot (P,I)
%plot(y,P,'b')
%hold on 
%plot(y,I,'r')
%hold off